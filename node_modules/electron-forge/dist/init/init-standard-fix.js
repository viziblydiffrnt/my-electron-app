'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _regenerator = require('babel-runtime/regenerator');

var _regenerator2 = _interopRequireDefault(_regenerator);

var _bluebird = require('bluebird');

var _debug = require('debug');

var _debug2 = _interopRequireDefault(_debug);

var _yarnOrNpm = require('../util/yarn-or-npm');

var _oraHandler = require('../util/ora-handler');

var _oraHandler2 = _interopRequireDefault(_oraHandler);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var d = (0, _debug2.default)('electron-forge:init:standard-fix');

var run = function () {
  var _ref = (0, _bluebird.coroutine)( /*#__PURE__*/_regenerator2.default.mark(function _callee(dir) {
    return _regenerator2.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return (0, _yarnOrNpm.yarnOrNpmSpawn)(['run', 'lint', '--', '--fix'], {
              stdio: 'inherit',
              cwd: dir
            });

          case 3:
            _context.next = 8;
            break;

          case 5:
            _context.prev = 5;
            _context.t0 = _context['catch'](0);
            throw new Error('Failed to fix JS to standard style (' + _context.t0.message + ')');

          case 8:
          case 'end':
            return _context.stop();
        }
      }
    }, _callee, undefined, [[0, 5]]);
  }));

  return function run(_x) {
    return _ref.apply(this, arguments);
  };
}();

exports.default = function () {
  var _ref2 = (0, _bluebird.coroutine)( /*#__PURE__*/_regenerator2.default.mark(function _callee3(dir) {
    return _regenerator2.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            _context3.next = 2;
            return (0, _oraHandler2.default)('Applying Standard Style to JS', (0, _bluebird.coroutine)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {
              return _regenerator2.default.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      d('executing "standard --fix" in:', dir);
                      _context2.next = 3;
                      return run(dir);

                    case 3:
                    case 'end':
                      return _context2.stop();
                  }
                }
              }, _callee2, undefined);
            })));

          case 2:
          case 'end':
            return _context3.stop();
        }
      }
    }, _callee3, undefined);
  }));

  return function (_x2) {
    return _ref2.apply(this, arguments);
  };
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluaXQvaW5pdC1zdGFuZGFyZC1maXguanMiXSwibmFtZXMiOlsiZCIsInJ1biIsImRpciIsInN0ZGlvIiwiY3dkIiwiRXJyb3IiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTs7OztBQUNBOztBQUVBOzs7Ozs7QUFFQSxJQUFNQSxJQUFJLHFCQUFNLGtDQUFOLENBQVY7O0FBRUEsSUFBTUM7QUFBQSwrRUFBTSxpQkFBT0MsR0FBUDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLG1CQUVGLCtCQUFlLENBQUMsS0FBRCxFQUFRLE1BQVIsRUFBZ0IsSUFBaEIsRUFBc0IsT0FBdEIsQ0FBZixFQUErQztBQUNuREMscUJBQU8sU0FENEM7QUFFbkRDLG1CQUFLRjtBQUY4QyxhQUEvQyxDQUZFOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQSxrQkFPRixJQUFJRyxLQUFKLDBDQUFpRCxZQUFJQyxPQUFyRCxPQVBFOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQU47O0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBTjs7O2dGQVdlLGtCQUFPSixHQUFQO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLG1CQUNQLDBCQUFTLCtCQUFULG9FQUEwQztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQzlDRix3QkFBRSxnQ0FBRixFQUFvQ0UsR0FBcEM7QUFEOEM7QUFBQSw2QkFFeENELElBQUlDLEdBQUosQ0FGd0M7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsYUFBMUMsR0FETzs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxHIiwiZmlsZSI6ImluaXQvaW5pdC1zdGFuZGFyZC1maXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVidWcgZnJvbSAnZGVidWcnO1xuaW1wb3J0IHsgeWFybk9yTnBtU3Bhd24gfSBmcm9tICcuLi91dGlsL3lhcm4tb3ItbnBtJztcblxuaW1wb3J0IGFzeW5jT3JhIGZyb20gJy4uL3V0aWwvb3JhLWhhbmRsZXInO1xuXG5jb25zdCBkID0gZGVidWcoJ2VsZWN0cm9uLWZvcmdlOmluaXQ6c3RhbmRhcmQtZml4Jyk7XG5cbmNvbnN0IHJ1biA9IGFzeW5jIChkaXIpID0+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCB5YXJuT3JOcG1TcGF3bihbJ3J1bicsICdsaW50JywgJy0tJywgJy0tZml4J10sIHtcbiAgICAgIHN0ZGlvOiAnaW5oZXJpdCcsXG4gICAgICBjd2Q6IGRpcixcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZml4IEpTIHRvIHN0YW5kYXJkIHN0eWxlICgke2Vyci5tZXNzYWdlfSlgKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKGRpcikgPT4ge1xuICBhd2FpdCBhc3luY09yYSgnQXBwbHlpbmcgU3RhbmRhcmQgU3R5bGUgdG8gSlMnLCBhc3luYyAoKSA9PiB7XG4gICAgZCgnZXhlY3V0aW5nIFwic3RhbmRhcmQgLS1maXhcIiBpbjonLCBkaXIpO1xuICAgIGF3YWl0IHJ1bihkaXIpO1xuICB9KTtcbn07XG4iXX0=